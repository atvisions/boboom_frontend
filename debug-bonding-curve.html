<!DOCTYPE html>
<html>
<head>
    <title>Debug Bonding Curve Progress</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #0E0E0E; color: white; }
        .debug-info { background: #1a1a1a; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .test-data { background: #2a2a2a; padding: 10px; margin: 5px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Bonding Curve Progress Debug</h1>
    
    <div class="debug-info">
        <h3>测试数据</h3>
        <div class="test-data">
            <strong>API返回的数据:</strong><br>
            graduationProgress: 80 (number)<br>
            graduation_progress: undefined<br>
            okbCollected: "160.000000000000000000"<br>
            phase: "CURVE_TRADING"
        </div>
    </div>
    
    <div class="debug-info">
        <h3>前端映射逻辑测试</h3>
        <div id="mapping-test"></div>
    </div>
    
    <div class="debug-info">
        <h3>组件渲染测试</h3>
        <div id="component-test"></div>
    </div>
    
    <script>
        // 模拟API数据
        const mockTokenData = {
            graduationProgress: 80,
            graduation_progress: undefined,
            okbCollected: "160.000000000000000000",
            phase: "CURVE_TRADING",
            name: "Q",
            symbol: "Q"
        };
        
        // 测试前端映射逻辑
        function testMapping() {
            console.log('=== 前端映射逻辑测试 ===');
            console.log('原始数据:', mockTokenData);
            
            const field1 = mockTokenData.graduationProgress;
            const field2 = mockTokenData.graduation_progress;
            const fallback = '0';
            
            console.log('字段检查:');
            console.log('  - graduationProgress:', field1, typeof field1);
            console.log('  - graduation_progress:', field2, typeof field2);
            console.log('  - 选择的值:', field1 || field2 || fallback);
            
            const rawValue = (field1 || field2 || fallback).toString();
            const progress = parseFloat(rawValue);
            
            console.log('解析结果:');
            console.log('  - 原始值:', rawValue);
            console.log('  - parseFloat结果:', progress);
            
            // 显示结果
            document.getElementById('mapping-test').innerHTML = `
                <strong>映射结果:</strong><br>
                原始值: ${rawValue}<br>
                解析后: ${progress}<br>
                类型: ${typeof progress}<br>
                是否为0: ${progress === 0 ? '是' : '否'}
            `;
            
            return progress;
        }
        
        // 测试组件渲染逻辑
        function testComponent() {
            const progress = testMapping();
            
            const getCurrentPhase = (progress) => {
                if (progress >= 100) return "Graduated";
                if (progress >= 80) return "Late Stage";
                if (progress >= 60) return "Mid Stage";
                if (progress >= 40) return "Early Stage";
                if (progress >= 20) return "Seed Stage";
                return "Launch Stage";
            };
            
            const currentPhase = getCurrentPhase(progress);
            
            document.getElementById('component-test').innerHTML = `
                <strong>组件渲染结果:</strong><br>
                进度值: ${progress.toFixed(1)}%<br>
                当前阶段: ${currentPhase}<br>
                预期显示: ${progress === 0 ? '0.0% (错误)' : progress.toFixed(1) + '% (正确)'}
            `;
            
            console.log('=== 组件渲染测试 ===');
            console.log('进度值:', progress);
            console.log('当前阶段:', currentPhase);
        }
        
        // 运行测试
        testComponent();
    </script>
</body>
</html>